

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basic Usage &mdash; CLoud Application Platform 0.2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Basic Configuration Setup" href="configuration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CLoud Application Platform
          

          
          </a>

          
            
            
              <div class="version">
                0.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Basic Configuration Setup</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#node-module">Node Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#command-node-start">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">start</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-node-list">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">list</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-node-alive">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">alive</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-node-show">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">show</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-node-stop">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">stop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-node-pause">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">pause</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-node-resume">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">resume</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-node-connect">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">connect</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-node-execute">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">execute</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-node-playbook">Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">playbook</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tags-module">Tags Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#group-module">Group Module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CLoud Application Platform</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Basic Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="basic-usage">
<span id="usage"></span><h1>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h1>
<p>CLAP is a platform to start, stop and manage cloud’s instances (called CLAP nodes or simply ,nodes) at different cloud providers transparently, based on configuration files. Also, it offers mechanisms to perform actions via SSH commands or Ansible playboks in single nodes or in a set of nodes in a row.
To provide this, in a modular way, CLAP provides modules to allow performing several operations (see &lt;ARCH&gt; section for more information about the CLAP architecture). You can use <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">--help</span></code> command to list the available modules or <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">-v</span> <span class="pre">--show-all</span></code> to show all available commands that can be used.</p>
<p>The most common modules are: <code class="docutils literal notranslate"><span class="pre">node</span></code>, <code class="docutils literal notranslate"><span class="pre">tags</span></code> and <code class="docutils literal notranslate"><span class="pre">groups</span></code>, described in next sections.</p>
<div class="section" id="node-module">
<span id="nodes-section"></span><h2>Node Module<a class="headerlink" href="#node-module" title="Permalink to this headline">¶</a></h2>
<p>The node module provides mechanisms to create, manage and interact with cloud’s instances. It provides the following features:</p>
<ul class="simple">
<li><p>Start nodes based on the instance templates with the <code class="docutils literal notranslate"><span class="pre">start</span></code> command</p></li>
<li><p>Stop (terminate) already started nodes using the <code class="docutils literal notranslate"><span class="pre">stop</span></code> command</p></li>
<li><p>Pause or resume already instantiated nodes using the <code class="docutils literal notranslate"><span class="pre">pause</span></code> and <code class="docutils literal notranslate"><span class="pre">resume</span></code> commands, respectively</p></li>
<li><p>Check the status of a node (if its accessible by SSH) using the <code class="docutils literal notranslate"><span class="pre">alive</span></code> command</p></li>
<li><p>List started nodes using the <code class="docutils literal notranslate"><span class="pre">list</span></code> command</p></li>
<li><p>Execute a shell command via SSH, using the <code class="docutils literal notranslate"><span class="pre">execute</span></code> command</p></li>
<li><p>Execute an Ansible Playbook using the <code class="docutils literal notranslate"><span class="pre">playbook</span></code> command</p></li>
<li><p>Obtain a shell session (via SSH) using the <code class="docutils literal notranslate"><span class="pre">connect</span></code> command</p></li>
</ul>
<p>All these commands are detailed below.</p>
<div class="section" id="command-node-start">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">start</span></code><a class="headerlink" href="#command-node-start" title="Permalink to this headline">¶</a></h3>
<p>To launch a cloud’s instance based on an instance template, defined in the <code class="docutils literal notranslate"><span class="pre">~/.clap/configs/instances.yaml</span></code> file, you can use the command below, where the <code class="docutils literal notranslate"><span class="pre">ubuntu-instance-aws</span></code> refers to the instance template ID defined in the <code class="docutils literal notranslate"><span class="pre">~/.clap/configs/instances.yaml</span></code> file. In this way, you need to configure the files only once and launch instances at any time.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node start ubuntu-instance-aws
</pre></div>
</div>
<p>Once instances are successfully started, CLAP will assign an unique node ID to each instance, used to perform other CLAP operation. Also, CLAP will try to login at the instance with the login information provided (via SSH).</p>
<p>To launch more than one instance with the same instance template ID, you can put the desired number after the instance template ID preceded by an <code class="docutils literal notranslate"><span class="pre">:</span></code>. For instance, the command below, launches 4 <code class="docutils literal notranslate"><span class="pre">ubuntu-instance-aws</span></code> instances in a row.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node start ubuntu-instance-aws:4
</pre></div>
</div>
<p>You can also launch different instances in a row using the same command, but just appending more instance template IDs to it, as below. The above command launches 2 <code class="docutils literal notranslate"><span class="pre">ubuntu-instance-aws</span></code> machines and 2 <code class="docutils literal notranslate"><span class="pre">example-instance-aws</span></code> machines in a row.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node start ubuntu-instance-aws:2 example-instance-aws:2
</pre></div>
</div>
</div>
<div class="section" id="command-node-list">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">list</span></code><a class="headerlink" href="#command-node-list" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">list</span></code> command can be used to show managed CLAP nodes. An example output of this command is shown below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>*  Node(id=`node-0`, type=`ubuntu-instance-aws`, status=`reachable`, public_ip=`54.152.26.1`, groups=``, tags=``, last_update=`02-05-20 14:48:04`
*  Node(id=`node-1`, type=`example-instance`, status=`reachable`, public_ip=`3.90.153.213`, groups=``, tags=``, last_update=`02-05-20 14:48:04`
Listed 2 node(s)
</pre></div>
</div>
<p>The node id (<code class="docutils literal notranslate"><span class="pre">node-0</span></code> and <code class="docutils literal notranslate"><span class="pre">node-1</span></code> in the above example) is used across all other modules and commands to perform commands in the specific node.</p>
</div>
<div class="section" id="command-node-alive">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">alive</span></code><a class="headerlink" href="#command-node-alive" title="Permalink to this headline">¶</a></h3>
<p>After the node is started, you can check if it is alive using the command <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">alive</span></code>. The command has the following sintax:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node alive [-h] [--tag TAG] [node_ids [node_ids ...]]
</pre></div>
</div>
<p>One or more node ids can be supplied to the command to check their aliveness. If no node id is supplied, all CLAP nodes is checked for their aliveness. Optionally you can filter nodes based in their tags (see <a class="reference internal" href="#tags-section"><span class="std std-ref">tags section</span></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">alive</span></code> command also updates the node status. Thus, each node can have the following status:</p>
<ul class="simple">
<li><p><strong>started</strong>:  when the cloud’s instance is successfully launched</p></li>
<li><p><strong>reachable</strong>: when the SSH login was successfully performed</p></li>
<li><p><strong>unreachable</strong>: when the login was not successfully performed</p></li>
<li><p><strong>paused</strong>: when node is paused</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">alive</span></code> command also updates the node connection IP and can be very useful when the node IP changes (e.g. and stopped node comes alive or when using floating IPs). As CLAP is an ad-hoc tool and does not monitor each node, its recommended to run this command periodically to update nodes information.</p>
</div>
</div>
<div class="section" id="command-node-show">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">show</span></code><a class="headerlink" href="#command-node-show" title="Permalink to this headline">¶</a></h3>
<p>For more detailed information of a CLAP node, you can use the <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">show</span></code> command, which have the sintax showed bellow. The node id is the unique ID associated to each CLAP node when it is started.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node show [-h] [--tag TAG] [node_ids [node_ids ...]]
</pre></div>
</div>
<p>One or more node ids can be supplied to the command to show information. If no node id is supplied, all CLAP nodes is shown. Optionally you can filter nodes based in their tags (see <a class="reference internal" href="#tags-section"><span class="std std-ref">tags section</span></a>).</p>
</div>
<div class="section" id="command-node-stop">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">stop</span></code><a class="headerlink" href="#command-node-stop" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">stop</span></code> command can be used to <strong>terminate</strong> an running instance (destroying it). The sintax is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node stop  [-h] [--tag TAG] node_ids [node_ids ...]
</pre></div>
</div>
<p>One or more node ids can be supplied to the command to stop them. Optionally you can filter nodes based in their tags (see <a class="reference internal" href="#tags-section"><span class="std std-ref">tags section</span></a>).</p>
</div>
<div class="section" id="command-node-pause">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">pause</span></code><a class="headerlink" href="#command-node-pause" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">pause</span></code> command can be used to <strong>pause</strong> an running instance. The sintax is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node pause [-h] [--tag TAG] node_ids [node_ids ...]
</pre></div>
</div>
<p>One or more node ids can be supplied to the command to pause them. Optionally you can filter nodes based in their tags (see <a class="reference internal" href="#tags-section"><span class="std std-ref">tags section</span></a>).
When a node is paused, it state is changed to <strong>paused</strong> and it’s public IP is changed to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The command has no effect for nodes that already been paused.</p>
</div>
</div>
<div class="section" id="command-node-resume">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">resume</span></code><a class="headerlink" href="#command-node-resume" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">resume</span></code> command can be used to <strong>resume</strong> an paused instance. The sintax is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node resume [-h] [--tag TAG] node_ids [node_ids ...]
</pre></div>
</div>
<p>One or more node ids can be supplied to the command to resume them. Optionally you can filter nodes based in their tags (see <a class="reference internal" href="#tags-section"><span class="std std-ref">tags section</span></a>).
When a node is resumed, it state is changed to <strong>started</strong>. Then, it checked if it is alive, testing its connection and updating its public I (changing its state to <strong>reachable</strong>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The command has no effect for nodes have not been paused, it will only check for its aliveness.</p>
</div>
</div>
<div class="section" id="command-node-connect">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">connect</span></code><a class="headerlink" href="#command-node-connect" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">connect</span></code> command can be used to obtain a shell to a specific node. The sintax is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node connect [-h] node_id
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The connection may fail if node has an invalid public IP or a invalid login information. You may want to check if node is alive firstto update node’s information.</p>
</div>
</div>
<div class="section" id="command-node-execute">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">execute</span></code><a class="headerlink" href="#command-node-execute" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">execute</span></code> command can be used to execute a shell command on an reachable node. The sintax is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node execute [-h] [--tag TAG] --command command [node_ids [node_ids ...]]
</pre></div>
</div>
<p>One or more node ids can be supplied to the command to execute the provided command in all of them. Optionally you can filter nodes based in their tags (see <a class="reference internal" href="#tags-section"><span class="std std-ref">tags section</span></a>).
The <code class="docutils literal notranslate"><span class="pre">--command</span></code> parameter specify the command that will be executed in nodes. An example is shwon below, executing a simple <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-lha</span></code> command in nodes <code class="docutils literal notranslate"><span class="pre">node-0</span></code> and <code class="docutils literal notranslate"><span class="pre">node-1</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node execute --command &quot;ls -lha&quot; node-0 node-1
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Nodes that cannot be reachable will be ignored. You may want to check for nodes aliveness first.</p>
</div>
</div>
<div class="section" id="command-node-playbook">
<h3>Command <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">playbook</span></code><a class="headerlink" href="#command-node-playbook" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clapp</span> <span class="pre">node</span> <span class="pre">playbook</span></code> command can be used to execute an Ansible playbook in a set of reachable nodes. The sintax is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node playbook [-h] [--tag TAG] [--extra ...] playbook_file [node_ids [node_ids ...]]
</pre></div>
</div>
<p>One or more node ids can be supplied to the command in order to execute the playbook in all of them. Optionally you can filter nodes based in their tags (see <a class="reference internal" href="#tags-section"><span class="std std-ref">tags section</span></a>). The playbook file must be a valid playbook file and the extra parameter is used if you want to pass keyword values to your playbook, and must be passed in the <code class="docutils literal notranslate"><span class="pre">key=value</span></code> format.</p>
<p>An example is shwon below. The playbook <code class="docutils literal notranslate"><span class="pre">playbook.yml</span></code> is executed in nodes <code class="docutils literal notranslate"><span class="pre">node-0</span></code> and <code class="docutils literal notranslate"><span class="pre">node-1</span></code>. Extra playbook variables (jinja format, e.g. “{{ var1 }}”) will be replaced by the extra variables informed. In the example below the playbook’s variable <code class="docutils literal notranslate"><span class="pre">var1</span></code> will be replaced by <code class="docutils literal notranslate"><span class="pre">value</span> <span class="pre">of</span> <span class="pre">var</span> <span class="pre">1</span></code> and the playbook’s variable <code class="docutils literal notranslate"><span class="pre">anothervar</span></code> will be replaced by <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clapp node playbook  playbook.yml node-0 node-1 --extra &quot;var1=value of var 1&quot; &quot;anothervar= 10&quot;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>For this command, the <code class="docutils literal notranslate"><span class="pre">extra</span></code> paramter <strong>must be the last</strong> parameter.</p></li>
<li><p>The Ansible playbook must use <strong>hosts: all</strong> as all select CLAP nodes will be put in the inventory as a single host. To specify different hosts in you playbook use the <a class="reference internal" href="#group-section"><span class="std std-ref">group command</span></a>, described in later sections.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="tags-module">
<span id="tags-section"></span><h2>Tags Module<a class="headerlink" href="#tags-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="group-module">
<span id="group-section"></span><h2>Group Module<a class="headerlink" href="#group-module" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="configuration.html" class="btn btn-neutral float-left" title="Basic Configuration Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Otávio Napoli

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>