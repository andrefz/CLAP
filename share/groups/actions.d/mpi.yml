---
actions:

  setup:
    playbook: roles/mpi.yml
    vars:
    - name: mount_ip
      description: if not specified the file system mounting step will be skipped
      optional: yes
    - name: skip_mpi
      description: Assign to "True" if want to skip, default is to install mpi
      optional: yes
    - name: use_instance_key
      description: >
                  Set to False if instance key from .clap/private/x.pem does not exist or you don't want to use it(
                  possibly to generate a new RSA key).
      optional: yes
 
  sync:
     playbook: roles/mpi/tasks/mpi-sync.yml
     vars:
        
         - name: src_dir
           description: >
                      Source directory (on localhost)
           optional: no
         - name: execution_dir
           description: The script to be executed
           optional: no
    

  install:
     playbook: roles/mpi/tasks/mpi-install.yml
     vars:
         - name: execution_dir
           description: >
                        Directory where the script should be executed on remote host
           optional: no
         - name: src_dir
           description: >
                      Directory containing files which the script depends(optional if script does not need such files)
           optional: yes
         - name: install_script
           description: The script to be executed
           optional: no

  compile:
     playbook: roles/mpi/tasks/mpi-compile.yml
     vars:
         - name: execution_dir
           optional: no
         - name: compile_script
           optional: no

  setup-keys:
     playbook: roles/mpi/tasks/mpi-setup-keys.yml
     vars:
         - name: key_name
           description: Name of the RSA key which will be stored in remote node's .ssh/ folder
           optional: yes

  compile-c:
    playbook: roles/mpi/tasks/mpi-compile-c.yml
    vars:
        - name: execution_dir
          optional: no
        - name: flags
          optional: yes
        - name: files
          optional: yes
        - name: output_file
          optional: yes


    run:
      playbook: roles/mpi/tasks/mpi-run.yml
      vars:
          - name: execution_dir
            optional: no
          - name: job_name
            optional: no
          - name: binary
            optional: no
          - name: binary_args
            optional: yes

hosts:                      # (optional) List of hosts that are used in this group (and in the playbooks)
- coordinator
- slave
