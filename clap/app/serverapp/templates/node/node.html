{% extends 'base.html' %}

{% block page %}

<script type="text/javascript">
    $.get('get-navigation-html', function(response){
        $("#navigation-items").replaceWith(response);
    })
</script>

<script type="text/javascript">
    window.addEventListener('DOMContentLoaded', (event) => {
        update_node_list()
    });

    function update_node_list(){
        $.get('get-node-list', function(response){
            console.log(response)
            table = $('#nodeTable').DataTable()
            table.rows().remove()

            for (node in response){
                node_id = response[node]['node_id'];
                node_instance_type = response[node]['instance_type']
                node_status = response[node]['status']
                node_ip = response[node]['ip']
                node_lifecycle = response[node]['lifecycle']
                node_update_time = response[node]['update_time']
                
                table.row.add([node_id, node_instance_type, node_status, node_ip, node_lifecycle, node_update_time]).draw(true)
            }

            $('#nodeTable tbody').on('click', 'tr', function () {
                $(this).toggleClass('table-active');
            });
        });
    }
    
</script>

<div id="nodeListContainer">
    <div id="nodeListTableDiv" class="table-responsive">
        <table id="nodeTable" class="table table-striped">
            <thead>
              <tr>
                <th scope="col">Node</th>
                <th scope="col">Type</th>
                <th scope="col">Status</th>
                <th scope="col">IP</th>
                <th scope="col">Lifecycle</th>
                <th scope="col">Update Time</th>
              </tr>
            </thead>
            
            <tbody>
            </tbody>
          </table>
    </div>

</div>



{% endblock %}